
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Overview | Symfony2日本語ドキュメント</title>
    <link rel="stylesheet" href="../../../../../../../../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../../../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../../../static/configurationblock.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../../../../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../../../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../../../../static/doctools.js"></script>
      <script type="text/javascript" src="../../../../../../../../static/js/jquery.corner.js"></script>
      <script type="text/javascript" src="../../../../../../../../static/configurationblock.js"></script>
      <script type="text/javascript">
      $(function(){
          $('.section h1').corner();
          $('.highlight-python pre').corner();
          $('.highlight-yml pre').corner();
          $('.highlight').corner();
      });
      </script>
    <link rel="top" title="Symfony2Doc 1.0.0 documentation" href="../../../../../../../../index.html" /> 
  </head>
  <body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=47270766548";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div id="all">
  <div id="content">
    <div id="content_wrapper">
      <div id="top_menu">
        <div id="top_menu_wrapper">
        </div>
      </div>
      <div id="header_top">
        <h1 id="logo_top"><a href="http://docs.symfony.gr.jp/">Symfonyユーザー会ドキュメントポータル</a></h1>
        <div id="header_top_left"></div>
      </div>
      <!-- end #header -->
      <div id="navbar">
        <ul>
          <li><a href="../../../../../../../../index.html">トップ（索引）</a></li>
          <li><a href="../../../../../../../../quick_tour/index.html">クイックツアー</a></li>
          <li><a href="../../../../../../../../book/index.html">ガイドブック</a></li>
          <li><a href="../../../../../../../../cookbook/index.html">クックブック</a></li>
          <li><a href="../../../../../../../../components/index.html">コンポーネント</a></li>
          <li><a href="../../../../../../../../reference/index.html">リファレンス</a></li>
          <li><a href="../../../../../../../../contributing/index.html">貢献</a></li>
        </ul>
      </div>
      <!-- end #navbar -->
      <div id="main">
<a href="/">Home</a> |
<a href="../../../../../../../../index.html">Symfony2Doc</a>

  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3>このページのコンテンツ</h3>
  <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li><a class="reference internal" href="#performance">Performance</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#annotations">Annotations</a><ul>
<li><a class="reference internal" href="#secure">&#64;Secure</a></li>
<li><a class="reference internal" href="#secureparam">&#64;SecureParam</a></li>
<li><a class="reference internal" href="#securereturn">&#64;SecureReturn</a></li>
<li><a class="reference internal" href="#runas">&#64;RunAs</a></li>
<li><a class="reference internal" href="#satisfiesparentsecuritypolicy">&#64;SatisfiesParentSecurityPolicy</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>ソース</h3>
  <ul class="this-page-menu">
    <li><a href="../../../../../../../../sources/osc2011-nagoya-symfony2-tutorial/Symfony/vendor/bundles/JMS/SecurityExtraBundle/Resources/doc/index.txt"
           rel="nofollow">ページのソースを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../../../../../../../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
          <br />
          <br />
          <div id="other">
            <h3>クイックリンク</h3>
            <ul>
              <li><a href="../../../../../../../../book/installation.html">インストール方法</a></li>
              <li><a href="../../../../../../../../reference/forms/types.html">FormTypeリファレンス</a></li>
              <li><a href="../../../../../../../../reference/constraints.html">バリデータリファレンス</a></li>
              <li><a href="http://twig.sensiolabs.org/documentation">Twigリファレンス</a></li>
              <li><a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/annotations-reference.html">Doctrine ORMアノテーションリファレンス</a></li>
            </ul>

<br />
            <h3>コメントリスト</h3>

<script type="text/javascript" src="http://symfony-japan.disqus.com/combination_widget.js?num_items=10&hide_mods=0&color=grey&default_tab=recent&excerpt_length=200"></script><a href="http://disqus.com/">Powered by Disqus</a>


            <br />
            <p>ご質問や翻訳不備等お気軽にコメントください。</p>

            <br />
          </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            

<p>コンテンツ上部に更新日の記載のないページは、翻訳の内容が2.0相当のものになっております。最新の内容は<a href="http://symfony.com/doc/current/osc2011-nagoya-symfony2-tutorial/Symfony/vendor/bundles/JMS/SecurityExtraBundle/Resources/doc/index.html">原文のページ</a>をご確認ください。</p>

  <div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>This bundle allows you to secure method invocations on your service layer with
annotations.</p>
<p>Generally, you can secure all public, or protected methods which are non-static,
and non-final. Private methods cannot be secured this way.</p>
<p>Annotations can also be declared on abstract methods, parent classes, or
interfaces.</p>
<div class="section" id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<p>The bundle will first collect all available security metadata for your services
from annotations. The metadata will then be used to build proxy classes which
have the requested security checks built-in. These proxy classes will replace
your original service classes. All of that is done automatically for you, you
don&#8217;t need to manually clear any cache if you make changes to the metadata.</p>
</div>
<div class="section" id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<p>While there will be virtually no performance difference in your production
environment, the performance in the development environment significantly
depends on your configuration (see the configuration section).</p>
<p>Generally, you will find that when you change the files of a secure service
the first page load after changing the file will increase. This is because
the cache for this service will need to be rebuilt, and a proxy class possibly
needs to be generated. Subsequent page loads will be very fast.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Checkout a copy of the code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">git</span> <span class="nx">submodule</span> <span class="nx">add</span> <span class="nx">https</span><span class="o">://</span><span class="nx">github</span><span class="o">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">schmittjoh</span><span class="o">/</span><span class="nx">SecurityExtraBundle</span><span class="o">.</span><span class="nx">git</span> <span class="nx">vendor</span><span class="o">/</span><span class="nx">bundles</span><span class="o">/</span><span class="nx">JMS</span><span class="o">/</span><span class="nx">SecurityExtraBundle</span>
</pre></div>
</div>
<p>Then register the bundle with your kernel:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// in AppKernel::registerBundles()</span>
<span class="nv">$bundles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="k">new</span> <span class="nx">JMS\SecurityExtraBundle\JMSSecurityExtraBundle</span><span class="p">(),</span>
    <span class="c1">// ...</span>
<span class="p">);</span>
</pre></div>
</div>
<p>This bundle also requires the Metadata library:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">git</span> <span class="nx">submodule</span> <span class="nx">add</span> <span class="nx">https</span><span class="o">://</span><span class="nx">github</span><span class="o">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">schmittjoh</span><span class="o">/</span><span class="nx">metadata</span><span class="o">.</span><span class="nx">git</span> <span class="nx">vendor</span><span class="o">/</span><span class="nx">metadata</span>
</pre></div>
</div>
<p>Make sure that you also register the namespaces with the autoloader:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/autoload.php</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">registerNamespaces</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="s1">&#39;JMS&#39;</span>              <span class="o">=&gt;</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor/bundles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Metadata&#39;</span>         <span class="o">=&gt;</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor/metadata/src&#39;</span><span class="p">,</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Below, you find the default configuration:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="nx">jms_security_extra</span><span class="o">:</span>
    <span class="c1"># If you set-up your controllers as services, you must set this to false;</span>
    <span class="c1"># otherwise your security checks will be performed twice.</span>
    <span class="nx">secure_controllers</span><span class="o">:</span> <span class="k">true</span>

    <span class="c1"># Whether you want to secure all services (true), or only secure specific</span>
    <span class="c1"># services (false); see also below</span>
    <span class="nx">secure_all_services</span><span class="o">:</span> <span class="k">false</span>

    <span class="c1"># Enabling this setting will add an additional special attribute &quot;IS_IDDQD&quot;.</span>
    <span class="c1"># Anybody with this attribute will effectively bypass all security checks.</span>
    <span class="nx">enable_iddqd_attribute</span><span class="o">:</span> <span class="k">false</span>
</pre></div>
</div>
<p>By default, security checks are not enabled for any service. You can turn on
security for your services either by securing all services as shown above, or
only for specific services by adding a tag to these services:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;</span><span class="nx">service</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;Bar&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">tag</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;security.secure_service&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="nx">service</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If you enable security for all services, be aware that the first page load will
be very slow depending on how many services you have defined.</p>
</div>
<div class="section" id="annotations">
<h2>Annotations<a class="headerlink" href="#annotations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="secure">
<h3>&#64;Secure<a class="headerlink" href="#secure" title="Permalink to this headline">¶</a></h3>
<p>This annotation lets you define who is allowed to invoke a method:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\Secure</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Secure(roles=&quot;ROLE_USER, ROLE_FOO, ROLE_ADMIN&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="secureparam">
<h3>&#64;SecureParam<a class="headerlink" href="#secureparam" title="Permalink to this headline">¶</a></h3>
<p>This annotation lets you define restrictions for parameters which are passed to
the method. This is only useful if the parameters are domain objects:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\SecureParam</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @SecureParam(name=&quot;comment&quot;, permissions=&quot;EDIT, DELETE&quot;)</span>
<span class="sd">     * @SecureParam(name=&quot;post&quot;, permissions=&quot;OWNER&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">(</span><span class="nv">$comment</span><span class="p">,</span> <span class="nv">$post</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="securereturn">
<h3>&#64;SecureReturn<a class="headerlink" href="#securereturn" title="Permalink to this headline">¶</a></h3>
<p>This annotation lets you define restrictions for the value which is returned by
the method. This is also only useful if the returned value is a domain object:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\SecureReturn</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @SecureReturn(permissions=&quot;VIEW&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>

        <span class="k">return</span> <span class="nv">$domainObject</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="runas">
<h3>&#64;RunAs<a class="headerlink" href="#runas" title="Permalink to this headline">¶</a></h3>
<p>This annotation lets you specifiy roles which are added only for the duration
of the method invocation. These roles will not be taken into consideration
for before, or after invocation access decisions.</p>
<p>This is typically used to implement a two-tier service layer where you have
public and private services, and private services are only to be invoked
through a specific public service:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\Secure</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\RunAs</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyPrivateService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Secure(roles=&quot;ROLE_PRIVATE_SERVICE&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">aMethodOnlyToBeInvokedThroughASpecificChannel</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">MyPublicService</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$myPrivateService</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * @Secure(roles=&quot;ROLE_USER&quot;)</span>
<span class="sd">     * @RunAs(roles=&quot;ROLE_PRIVATE_SERVICE&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">canBeInvokedFromOtherServices</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">myPrivateService</span><span class="o">-&gt;</span><span class="na">aMethodOnlyToBeInvokedThroughASpecificChannel</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="satisfiesparentsecuritypolicy">
<h3>&#64;SatisfiesParentSecurityPolicy<a class="headerlink" href="#satisfiesparentsecuritypolicy" title="Permalink to this headline">¶</a></h3>
<p>This must be defined on a method that overrides a method which has security metadata.
It is there to ensure that you are aware the security of the overridden method cannot
be enforced anymore, and that you must copy over all annotations if you want to keep
them.</p>
</div>
</div>
</div>


<div id="page_prev_next">
</div>

<div class="common_content_footer">
<ul>
  <li> → <a href="http://symfony.com/doc/current/osc2011-nagoya-symfony2-tutorial/Symfony/vendor/bundles/JMS/SecurityExtraBundle/Resources/doc/index.html">公式英語ドキュメント</a></li>
  <li> → <a href="https://github.com/symfony/symfony-docs/commits/master/osc2011-nagoya-symfony2-tutorial/Symfony/vendor/bundles/JMS/SecurityExtraBundle/Resources/doc/index.rst">原文コミット履歴</a>
  <li> → <a href="https://github.com/symfony-japan/symfony-docs-ja/commits/master/osc2011-nagoya-symfony2-tutorial/Symfony/vendor/bundles/JMS/SecurityExtraBundle/Resources/doc/index.rst">翻訳コミット履歴</a>
</ul>
<br />
翻訳の不備などは、お気軽にコメント欄にてご指摘ください。
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'symfony-japan'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<div class="fb-like-box" data-href="http://www.facebook.com/symfonyjapan" data-width="203" data-show-faces="true" data-stream="true" data-border-color="#FFF" data-header="true"></div>

          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>

      </div>
      <!-- end #main -->
    </div>
    <!-- end #content_wrapper -->
  </div>
  <!-- end #content -->


  <div id="footer">
    <div id="footer_wrapper">
      <div id="footer_content">
        <div style=" position: relative;">
          <div id="footer_left"></div>
          <div id="footer_right"></div>
        </div>
        <div id="f_navbar">
        <ul>
          <li><a href="../../../../../../../../index.html">トップ（索引）</a></li>
          <li><a href="../../../../../../../../quick_tour/index.html">クイックツアー</a></li>
          <li><a href="../../../../../../../../book/index.html">ガイドブック</a></li>
          <li><a href="../../../../../../../../cookbook/index.html">クックブック</a></li>
          <li><a href="../../../../../../../../components/index.html">コンポーネント</a></li>
          <li><a href="../../../../../../../../reference/index.html">リファレンス</a></li>
          <li><a href="../../../../../../../../contributing/index.html">貢献</a></li>
        </ul>
      </div>
      <!-- end #navbar -->
        <div>
          <p id="copyright">
            <a href="../../../../../../../../contributing/documentation/license.html">ドキュメントの著作権</a>は Symfony 公式に準じます(Creative Commons Attribution-Share Alike 3.0 Unported ライセンス)。<br />
            Copyright &copy; 2014 Symfony Japan. All rights reserved.<br />
            &nbsp;&nbsp;&nbsp;Bandwidth and hardware provided by <a href="http://www.asial.co.jp/">アシアル株式会社</a>
            &nbsp;&nbsp;Powered by <a href="http://sphinx.pocoo.org/">Sphinx</a>
          </p>
        </div>
      </div>
      <!-- end #footer_content -->
        </div>
        <!-- end #footer_wrapper -->
      </div>
      <!-- end #footer -->
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16659283-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>
