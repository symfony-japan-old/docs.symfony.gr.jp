
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="noindex">
    
    <title>コントローラー | Symfony2日本語ドキュメント</title>
    <link rel="stylesheet" href="../static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/configurationblock.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
      <script type="text/javascript" src="../static/js/jquery.corner.js"></script>
      <script type="text/javascript" src="../static/configurationblock.js"></script>
      <script type="text/javascript">
      $(function(){
          $('.section h1').corner();
          $('.highlight-python pre').corner();
          $('.highlight-yml pre').corner();
          $('.highlight').corner();
      });
      </script>
    <link rel="top" title="Symfony2Doc 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="ガイドブック" href="index.html" />
    <link rel="next" title="ルーティング" href="routing.html" />
    <link rel="prev" title="Symfony2 でのページ作成" href="page_creation.html" /> 
  </head>
  <body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId=47270766548";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div id="all">
  <div id="content">
    <div id="content_wrapper">
      <div id="top_menu">
        <div id="top_menu_wrapper">
        </div>
      </div>
      <div id="header_top">
        <h1 id="logo_top"><a href="http://docs.symfony.gr.jp/">Symfonyユーザー会ドキュメントポータル</a></h1>
        <div id="header_top_left"></div>
      </div>
      <!-- end #header -->
      <div id="navbar">
        <ul>
          <li><a href="../index.html">トップ（索引）</a></li>
          <li><a href="../quick_tour/index.html">クイックツアー</a></li>
          <li><a href="index.html">ガイドブック</a></li>
          <li><a href="../best_practices/index.html">ベストプラクティス</a></li>
          <li><a href="../cookbook/index.html">クックブック</a></li>
          <li><a href="../components/index.html">コンポーネント</a></li>
          <li><a href="../reference/index.html">リファレンス</a></li>
          <li><a href="../contributing/index.html">貢献</a></li>
        </ul>
      </div>
      <!-- end #navbar -->
      <div id="main">
<a href="/">Home</a> |
<a href="../index.html">Symfony2Doc</a>
&raquo;<a href="index.html">ガイドブック</a>
&raquo;コントローラー

  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3>このページのコンテンツ</h3>
  <ul>
<li><a class="reference internal" href="#">コントローラー</a><ul>
<li><a class="reference internal" href="#index-1">リクエスト、コントローラー、レスポンスのライフサイクル</a></li>
<li><a class="reference internal" href="#index-2">シンプルなコントローラー</a></li>
<li><a class="reference internal" href="#url">URL をコントローラーにマッピングする</a><ul>
<li><a class="reference internal" href="#route-parameters-controller-arguments">ルートパラメーターとコントローラーの引数の関係</a></li>
<li><a class="reference internal" href="#request">コントローラー引数としての <tt class="docutils literal"><span class="pre">Request</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#index-5">静的ページの作成</a></li>
<li><a class="reference internal" href="#id6">基底コントローラークラス</a></li>
<li><a class="reference internal" href="#index-6">一般的なコントローラータスク</a><ul>
<li><a class="reference internal" href="#index-7">リダイレクト</a></li>
<li><a class="reference internal" href="#index-8">フォワード</a></li>
<li><a class="reference internal" href="#controller-rendering-templates">テンプレートのレンダリング</a></li>
<li><a class="reference internal" href="#index-10">他のサービスへのアクセス</a></li>
</ul>
</li>
<li><a class="reference internal" href="#index-11">エラーと 404</a></li>
<li><a class="reference internal" href="#index-12">セッション管理</a><ul>
<li><a class="reference internal" href="#index-13">フラッシュメッセージ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#index-14">レスポンスオブジェクト</a></li>
<li><a class="reference internal" href="#index-15">リクエストオブジェクト</a></li>
<li><a class="reference internal" href="#id17">まとめ</a></li>
<li><a class="reference internal" href="#id18">クックブックでより深く</a></li>
</ul>
</li>
</ul>

  <h4>前のドキュメント</h4>
  <p class="topless"><a href="page_creation.html"
                        title="previous chapter">Symfony2 でのページ作成</a></p>
  <h4>次のドキュメント</h4>
  <p class="topless"><a href="routing.html"
                        title="next chapter">ルーティング</a></p>
  <h3>ソース</h3>
  <ul class="this-page-menu">
    <li><a href="../sources/book/controller.txt"
           rel="nofollow">ページのソースを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
          <br />
          <br />
          <div id="other">
            <h3>クイックリンク</h3>
            <ul>
              <li><a href="installation.html">インストール方法</a></li>
              <li><a href="../reference/forms/types.html">FormTypeリファレンス</a></li>
              <li><a href="../reference/constraints.html">バリデータリファレンス</a></li>
              <li><a href="http://twig.sensiolabs.org/documentation">Twigリファレンス</a></li>
              <li><a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/annotations-reference.html">Doctrine ORMアノテーションリファレンス</a></li>
            </ul>

<br />
            <h3>コメントリスト</h3>

<script type="text/javascript" src="http://symfony-japan.disqus.com/combination_widget.js?num_items=10&hide_mods=0&color=grey&default_tab=recent&excerpt_length=200"></script><a href="http://disqus.com/">Powered by Disqus</a>


            <br />
            <p>ご質問や翻訳不備等お気軽にコメントください。</p>

            <br />
          </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            

<div class="admonition note" style="background-color: #f2dede;"><p class="first admonition-title">ご注意</p><p style="font-weight: bold;">Symfony2日本語翻訳ドキュメントは内容が古くなっております。<a href="http://symfony.com/doc/current/index.html">公式サイト</a>の英語ドキュメントを参照してください。</p></div>

  <div class="admonition note" id="index-0">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>対象バージョン：2.4 (2.2以降)</li>
<li>翻訳更新日：2014/1/1</li>
</ul>
</div>
<div class="section" id="id1">
<h1>コントローラー<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>コントローラーは、HTTP リクエストから情報を取得し、(Symfony2 の <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトとして) HTTP レスポンスを作成して返す PHP 関数です。レスポンスは、HTML ページ、XML ドキュメント、シリアライズされた JSON 配列、画像、リダイレクト、404 エラー、その他思いつく物なんでもよいでしょう。コントローラーには、<em>あなたのアプリケーション</em>が、ページコンテンツをレンダリングする際に必要な任意のロジックが盛り込まれます。</p>
<p>このことがどれだけシンプルなことなのか、Symfony2 コントローラーが実際に動作しているところを見ていきましょう。次のコードは、<tt class="docutils literal"><span class="pre">Hello</span> <span class="pre">world!</span></tt> と出力するページをレンダリングするコントローラーの例です。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">helloAction</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Hello world!&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>コントローラーの表面的な役割は常に 1 つです。すなわち、<tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを作成して返すことです。そこに至るまでに、リクエストからの情報の読み込みや、データベースリソースの読み込み、メールの送信、ユーザーのセッションへの情報の設定を行うかもしれませんが、どの場合においても、コントローラーは最終的にはクライアントに届けることになる <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを返します。</p>
<p>いくつかよくある例を見てみましょう。</p>
<ul class="simple">
<li><em>コントローラー A</em> サイトのトップページコンテンツである <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを準備する。</li>
<li><em>コントローラー B</em> リクエストから <tt class="docutils literal"><span class="pre">slug</span></tt> パラメーターを読み込み、データベースからブログエントリを取得するためにそれを使用し、そのブログを表示する <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを作成する。もし <tt class="docutils literal"><span class="pre">slug</span></tt> がデータベース中に見つからなければ、ステータスコード 404 の <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを作成します。</li>
<li><em>コントローラー C</em> お問い合わせフォームの送信を扱う。リクエストからフォームの情報を読み込み、データベースにセーブし、ウェブマスターにその情報をメールします。最終的には、クライアントのブラウザをお礼ページにリダイレクトさせる <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを作成します。</li>
</ul>
<div class="section" id="index-1">
<span id="id2"></span><h2>リクエスト、コントローラー、レスポンスのライフサイクル<a class="headerlink" href="#index-1" title="Permalink to this headline">¶</a></h2>
<p>Symfony2 プロジェクトによって処理されるリクエストは、全て同じシンプルなライフサイクルに従っています。フレームワークが、なんども繰り返されるようなタスクを解決し、あなたの作成したコードが格納されているコントローラーを実行します。</p>
<ol class="arabic simple">
<li>各リクエストは、単一のフロントコントローラーファイル(<tt class="docutils literal"><span class="pre">app.php</span></tt> や <tt class="docutils literal"><span class="pre">app_dev.php</span></tt>)によって処理され、アプリケーションがブートされます。</li>
<li><tt class="docutils literal"><span class="pre">Router</span></tt> が、リクエストから情報(URI)を読み込み、その情報にマッチするルートを見つけ、そのルートの <tt class="docutils literal"><span class="pre">_controller</span></tt> パラメーターを読み込みます。</li>
<li>マッチしたルートのコントローラーが実行され、コントローラー内のコードにより <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトが作成され、返されます。</li>
<li>HTTP ヘッダと <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトのコンテンツがクライアントに送り返されます。</li>
</ol>
<p>ページを作成するということはとても簡単で、コントローラーの作成(#3)を行い、URL をそのコントローラーにマップするルートの作成(#2)を行うということになります。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">似たような名前ですが、「フロントコントローラー」は、この章で話す「コントローラー」とは別ものです。フロントコントローラーは、小さな PHP ファイルで公開領域に配置されており、全てのリクエストが通過します。典型的なアプリケーションでは、プロダクション用のフロントコントローラー(<tt class="docutils literal"><span class="pre">app.php</span></tt>)と、開発用のフロントコントローラー(<tt class="docutils literal"><span class="pre">app_dev.php</span></tt>)が存在するでしょう。このファイルを編集したり参照したり思い悩むことはおそらく無いでしょう。</p>
</div>
</div>
<div class="section" id="index-2">
<span id="id3"></span><h2>シンプルなコントローラー<a class="headerlink" href="#index-2" title="Permalink to this headline">¶</a></h2>
<p>コントローラーは、PHP の Callable (関数、オブジェクトのメソッド、<tt class="docutils literal"><span class="pre">クロージャー</span></tt>) であればよく、特に Symfony2 では、コントローラークラス内の 1 つのメソッドのことを指します。コントローラーは、<em>アクション</em>とも呼びます。</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// src/Acme/HelloBundle/Controller/HelloController.php</span>
<span class="k">namespace</span> <span class="nx">Acme\HelloBundle\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">HelloController</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;&lt;html&gt;&lt;body&gt;Hello &#39;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s1">&#39;!&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><em>コントローラー</em>は <tt class="docutils literal"><span class="pre">indexAction</span></tt> メソッドであり、<em>コントローラークラス</em>(<tt class="docutils literal"><span class="pre">HelloController</span></tt>) 内に存在していることに注意してください。<em>コントローラークラス</em>と呼ぶのは、単に複数のコントローラー/アクションをグループ化するのに便利だからです。典型的にはコントローラークラスは複数のコントローラー/アクションを内包することになるでしょう(<tt class="docutils literal"><span class="pre">updateAction</span></tt> や <tt class="docutils literal"><span class="pre">deleteAction</span></tt> など)。</p>
</div>
<p>このコントローラーはとても単純です。</p>
<ul class="simple">
<li><em>4 行目</em>: Symfony2 は PHP 5.3 の名前空間機能をうまく利用して、コントローラークラス全体を名前空間付けしています。<tt class="docutils literal"><span class="pre">use</span></tt> キーワードで、コントローラーの戻り値として利用する <tt class="docutils literal"><span class="pre">Response</span></tt> クラスをインポートしています。</li>
<li><em>6 行目</em>: クラス名は、そのコントローラーの名前 (<tt class="docutils literal"><span class="pre">Hello</span></tt>) と <tt class="docutils literal"><span class="pre">Controller</span></tt> という文字列を結合したものです。これは、コントローラー群に一貫性を提供し、ルーティング設定の際に最初の部分 (<tt class="docutils literal"><span class="pre">Hello</span></tt>) のみの参照で済むようにするための慣習です。</li>
<li><em>8 行目</em>: コントローラークラス内の各アクションは、サフィックスとして <tt class="docutils literal"><span class="pre">Action</span></tt> を付けます。ルーティングの設定では、アクション名 (<tt class="docutils literal"><span class="pre">index</span></tt>) のみで参照されます。次節では、ルート (URI をアクションにマッピングする) を作成しますが、そのルートのプレースホルダ (<tt class="docutils literal"><span class="pre">{name}</span></tt>) が、どうやってアクションメソッドの引数 (<tt class="docutils literal"><span class="pre">$name</span></tt>) になっていくのかを見ていきます。</li>
<li><em>10 行目</em>: コントローラーが <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを作成して返します。</li>
</ul>
</div>
<div class="section" id="url">
<span id="index-3"></span><h2>URL をコントローラーにマッピングする<a class="headerlink" href="#url" title="Permalink to this headline">¶</a></h2>
<p>先程のコントローラーはシンプルな HTML ページを返します。ですが、実際にブラウザで確認するには、ルートを作成する必要があります。ルートは、特定の URL パスをコントローラーにマッピングするものです。</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/routing.yml</span>
<span class="l-Scalar-Plain">hello</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span>      <span class="l-Scalar-Plain">/hello/{name}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeHelloBundle</span><span class="p-Indicator">:</span><span class="nv">Hello</span><span class="p-Indicator">:</span><span class="nv">index</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/routing.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing</span>
<span class="s">        http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;hello&quot;</span> <span class="na">path=</span><span class="s">&quot;/hello/{name}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeHelloBundle:Hello:index<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/routing.php</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Route</span><span class="p">(</span><span class="s1">&#39;/hello/{name}&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;_controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;AcmeHelloBundle:Hello:index&#39;</span><span class="p">,</span>
<span class="p">)));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ルート定義に使う <tt class="docutils literal"><span class="pre">path</span></tt> オプションは、Symfony 2.2 以降のものです。
Symfony 2.1 までは <tt class="docutils literal"><span class="pre">pattern</span></tt> というオプションでした。</p>
</div>
<p>これで、<tt class="docutils literal"><span class="pre">/hello/ryan</span></tt> にアクセスすると <tt class="docutils literal"><span class="pre">HelloController::indexAction()</span></tt> コントローラーが実行され、<tt class="docutils literal"><span class="pre">$name</span></tt> 変数として <tt class="docutils literal"><span class="pre">ryan</span></tt> が渡されるようになります。Symfony において「ページ」を作成するということは、単純にコントローラーメソッドを作成し、ルートと関連付けることを意味します。</p>
<p>コントローラーを指定する構文 <tt class="docutils literal"><span class="pre">AcmeHelloBundle:Hello:index</span></tt> に注意してください。Symfony2 はコントローラーを指定するために、柔軟な記法を使用しています。この例は最も一般的な構文で、<tt class="docutils literal"><span class="pre">AcmeHelloBundle</span></tt> という名前のバンドルにある <tt class="docutils literal"><span class="pre">HelloController</span></tt> というクラスを探すように伝えています。そして、<tt class="docutils literal"><span class="pre">indexAction()</span></tt> メソッドが実行されます。</p>
<p>コントローラーを指定する文字列フォーマットについて、詳細は <a class="reference internal" href="routing.html#controller-string-syntax"><em>コントローラーの指定パターン</em></a> を参照してください。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">この例では、<tt class="docutils literal"><span class="pre">app/config/</span></tt> ディレクトリにある <tt class="docutils literal"><span class="pre">routing.yml</span></tt> にルート設定を直接記述していますが、ルートが属しているバンドル配下のファイルに記述することをおすすめします。詳細は <a class="reference internal" href="routing.html#routing-include-external-resources"><em>外部のルーティングリソースをインクルード</em></a> を参照してください。</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">ルーティングに関してもっと学びたい場合は、<a class="reference internal" href="routing.html"><em>ルーティング</em></a>を参照してください。</p>
</div>
<div class="section" id="route-parameters-controller-arguments">
<span id="index-4"></span><span id="id4"></span><h3>ルートパラメーターとコントローラーの引数の関係<a class="headerlink" href="#route-parameters-controller-arguments" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">_controller</span></tt> パラメーターである <tt class="docutils literal"><span class="pre">AcmeHelloBundle:Hello:index</span></tt> が、<tt class="docutils literal"><span class="pre">AcmeHelloBundle</span></tt> 内の <tt class="docutils literal"><span class="pre">HelloController::indexAction()</span></tt> メソッドを指定していることはわかりましたね。もっとおもしろいのは、そのメソッドに渡される引数の話です。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/HelloBundle/Controller/HelloController.php</span>
<span class="k">namespace</span> <span class="nx">Acme\HelloBundle\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">HelloController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>このコントローラーは <tt class="docutils literal"><span class="pre">$name</span></tt> 引数をもっており、マッチしたルートの <tt class="docutils literal"><span class="pre">{name}</span></tt> パラメーターに対応しています (今回の例では <tt class="docutils literal"><span class="pre">ryan</span></tt> という値)。実際には、コントローラーが実行されるとき、Symfony2 はコントローラーの各引数とルートのパラメーターをマッチさせています。次の例を見てください。</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/routing.yml</span>
<span class="l-Scalar-Plain">hello</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span>      <span class="l-Scalar-Plain">/hello/{firstName}/{lastName}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeHelloBundle</span><span class="p-Indicator">:</span><span class="nv">Hello</span><span class="p-Indicator">:</span><span class="nv">index</span><span class="p-Indicator">,</span> <span class="nv">color</span><span class="p-Indicator">:</span> <span class="nv">green</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/routing.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing</span>
<span class="s">        http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;hello&quot;</span> <span class="na">path=</span><span class="s">&quot;/hello/{firstName}/{lastName}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeHelloBundle:Hello:index<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;color&quot;</span><span class="nt">&gt;</span>green<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/config/routing.php</span>
<span class="nv">$collection</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Route</span><span class="p">(</span><span class="s1">&#39;/hello/{firstName}/{lastName}&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;_controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;AcmeHelloBundle:Hello:index&#39;</span><span class="p">,</span>
    <span class="s1">&#39;color&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="p">)));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>この例のルート用のコントローラーは、複数の引数をとることができます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$firstName</span><span class="p">,</span> <span class="nv">$lastName</span><span class="p">,</span> <span class="nv">$color</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>プレースホルダー変数 (<tt class="docutils literal"><span class="pre">{firstName}</span></tt>, <tt class="docutils literal"><span class="pre">{lastName}</span></tt>) もそうですが、デフォルトの <tt class="docutils literal"><span class="pre">color</span></tt> 変数も、コントローラーの引数として有効です。ルートがマッチした際に、プレースホルダーの変数が、<tt class="docutils literal"><span class="pre">defaults</span></tt> と共にマージされ、コントローラー内で使用できるように 1 つの配列として作成されます。</p>
<p>ルートパラメーターをコントローラーの引数にマッピングするのはとても簡単で柔軟性があります。開発時に下記のガイドラインを心に留めておいてください。</p>
<ul>
<li><p class="first"><strong>コントローラーの引数の順番は関係ない</strong></p>
<blockquote>
<div><p>Symfony は、ルートのパラメーター名を、コントローラーメソッドの表記にある変数名にマッチさせることができます。言い換えると、<tt class="docutils literal"><span class="pre">{lastName}</span></tt> パラメーターは <tt class="docutils literal"><span class="pre">$lastName</span></tt> にマッチするということです。コントローラーの引数の順は、全く異なる順番でもうまく動きます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$lastName</span><span class="p">,</span> <span class="nv">$color</span><span class="p">,</span> <span class="nv">$first_name</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>必須な引数は必ずルーティングパラメーターとマッチする必要がある</strong></p>
<blockquote>
<div><p>次の例では <tt class="docutils literal"><span class="pre">RuntimeException</span></tt> がスローされます。ルートに <tt class="docutils literal"><span class="pre">foo</span></tt> パラメーターが定義されていないからです。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$firstName</span><span class="p">,</span> <span class="nv">$lastName</span><span class="p">,</span> <span class="nv">$color</span><span class="p">,</span> <span class="nv">$foo</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>ただし、オプションにしてしまえば全く問題ありません。次の例では例外はスローされません。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$firstName</span><span class="p">,</span> <span class="nv">$lastName</span><span class="p">,</span> <span class="nv">$color</span><span class="p">,</span> <span class="nv">$foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>全てのルーティングパラメーターをコントローラー引数に使う必要はない</strong></p>
<blockquote>
<div><p>例えば、<tt class="docutils literal"><span class="pre">last_name</span></tt> パラメーターがコントローラーにとって重要でないのであれば、完全に省略しても大丈夫です。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$first_name</span><span class="p">,</span> <span class="nv">$color</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">全てのルートは特別なパラメーターである <tt class="docutils literal"><span class="pre">_route</span></tt> を持っています。このパラメーターは、マッチしたルートの名前(<tt class="docutils literal"><span class="pre">hello</span></tt>)を意味します。いつも便利かというとそうでもありませんが、これもコントローラーの引数として同様に有効です。</p>
</div>
</div>
<div class="section" id="request">
<span id="book-controller-request-argument"></span><h3>コントローラー引数としての <tt class="docutils literal"><span class="pre">Request</span></tt><a class="headerlink" href="#request" title="Permalink to this headline">¶</a></h3>
<p>簡単にするため、コントローラーに引数として <tt class="docutils literal"><span class="pre">Request</span></tt> オブジェクトを渡すようにすることも可能です。特にフォームを扱っている場合に便利です。次の例を見てください。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">updateAction</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createForm</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>

    <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="index-5">
<span id="id5"></span><h2>静的ページの作成<a class="headerlink" href="#index-5" title="Permalink to this headline">¶</a></h2>
<p>コントローラーを利用せず、ルートとテンプレートのみで静的ページを作ることもできます。</p>
<p><tt class="xref doc docutils literal"><span class="pre">/cookbook/templating/render_without_controller</span></tt> を参照してください。</p>
</div>
<div class="section" id="id6">
<h2>基底コントローラークラス<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>Symfony2 には、基底 <tt class="docutils literal"><span class="pre">Controller</span></tt> クラスが用意されています。このクラスは、一般的なコントローラータスクを補助してくれたり、必要となるであろうあらゆるリソースへのアクセスを提供してくれます。この <tt class="docutils literal"><span class="pre">Controller</span></tt> クラスを継承することで、いくつかのヘルパメソッドを有効利用することができます。
<tt class="docutils literal"><span class="pre">Controller</span></tt> クラスの先頭に <tt class="docutils literal"><span class="pre">use</span></tt> ステイトメントを付加し、それを継承するように <tt class="docutils literal"><span class="pre">HelloController</span></tt> を変更します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/HelloBundle/Controller/HelloController.php</span>
<span class="k">namespace</span> <span class="nx">Acme\HelloBundle\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">HelloController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;&lt;html&gt;&lt;body&gt;Hello &#39;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s1">&#39;!&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>この時点では特にコントローラーの処理が変わったわけではありません。次節では、基底コントローラークラスの存在により使用可能となるヘルパーメソッドを見ていきます。これらのメソッドは、単に Symfony2 の機能へのショートカットです。その機能自体は、基底 <tt class="docutils literal"><span class="pre">Controller</span></tt> クラスを通しても通さなくても利用可能です。実際のコア機能を参照するには、<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/FrameworkBundle/Controller/Controller.html" title="Symfony\Bundle\FrameworkBundle\Controller\Controller"><span class="pre">Controller</span></a></tt> を見るとよいでしょう。</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Symfony では、この基底クラスを継承するのは <em>オプション</em>です。便利なショートカットはありますが、強制ではありません。<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/DependencyInjection/ContainerAware.html" title="Symfony\Component\DependencyInjection\ContainerAware"><span class="pre">ContainerAware</span></a></tt> クラスを継承したり、
PHP 5.4 以降であれば <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/DependencyInjection/ContainerAwareTrait.html" title="Symfony\Component\DependencyInjection\ContainerAwareTrait"><span class="pre">ContainerAwareTrait</span></a></tt> トレイトを使うこともできます。
こうすると <tt class="docutils literal"><span class="pre">container</span></tt> プロパティ経由でサービスコンテナにアクセスできます。</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.4: </span><tt class="docutils literal"><span class="pre">ContainerAwareTrait</span></tt> は Symfony 2.4 で追加されました。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="../cookbook/controller/service.html"><em>コントローラーをサービスとして定義する</em></a>こともできます。
コントローラーで利用する依存を明示的に制御できるようになります。</p>
</div>
</div>
<div class="section" id="index-6">
<span id="id7"></span><h2>一般的なコントローラータスク<a class="headerlink" href="#index-6" title="Permalink to this headline">¶</a></h2>
<p>コントローラーが実質的になんでもできるとは言っても、ほとんどのコントローラーでは、同じ基礎的なタスクを何度も何度も行うことになるでしょう。Symfony2 では、リダイレクトやフォワード、テンプレートのレンダリング、コアサービスへのアクセスといったことを、とても簡単に扱うことができます。</p>
<div class="section" id="index-7">
<span id="id8"></span><h3>リダイレクト<a class="headerlink" href="#index-7" title="Permalink to this headline">¶</a></h3>
<p>ユーザーを別のページへリダイレクトさせたいときは、<tt class="docutils literal"><span class="pre">redirect()</span></tt> メソッドを使用します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="s1">&#39;homepage&#39;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">generateUrl()</span></tt> メソッドは、与えられたルートに対する URL を生成するヘルパ関数です。詳細な情報は、<a class="reference internal" href="routing.html"><em>ルーティング</em></a> 章を参照してください。</p>
<p>デフォルトでは、<tt class="docutils literal"><span class="pre">redirect()</span></tt> メソッドは 302(temporary) リダイレクトとして動作します。301(permanent) としてリダイレクトさせるには、第二引数を変更します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="s1">&#39;homepage&#39;</span><span class="p">),</span> <span class="mi">301</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><tt class="docutils literal"><span class="pre">redirect()</span></tt> メソッドは、ユーザーをリダイレクトさせることに特化した <tt class="docutils literal"><span class="pre">Resoponse</span></tt> オブジェクトを作成するショートカットです。これは、次のコードと同等です。</p>
<div class="last highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\RedirectResponse</span><span class="p">;</span>

<span class="k">return</span> <span class="k">new</span> <span class="nx">RedirectResponse</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="s1">&#39;homepage&#39;</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="index-8">
<span id="id9"></span><h3>フォワード<a class="headerlink" href="#index-8" title="Permalink to this headline">¶</a></h3>
<p>内部的に別のコントローラーへフォワードさせることも簡単にできます。これには <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Bundle/FrameworkBundle/Controller/Controller.html#method_forward" title="Symfony\Bundle\FrameworkBundle\Controller\Controller::forward()"><span class="pre">forward()</span></a></tt> メソッドを使用します。ブラウザにリダイレクトさせるのではなく、内部的なサブリクエストを作成し、指定されたコントローラーを呼び出します。<tt class="docutils literal"><span class="pre">forward()</span></tt> メソッドは、その呼び出されたコントローラーが作成する <tt class="docutils literal"><span class="pre">Resopnse</span></tt> オブジェクトを返します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">forward</span><span class="p">(</span><span class="s1">&#39;AcmeHelloBundle:Hello:fancy&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
    <span class="p">));</span>

    <span class="c1">// ... レスポンスをさらに加工するか、直接返す</span>

    <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><cite>forward()</cite> メソッドは、ルーティングの設定で使用したものと同じコントローラー表現を使っていることに注意してください。この場合であれば、ターゲットとなるコントローラークラスは、<tt class="docutils literal"><span class="pre">AcmeHelloBundle</span></tt> 内の <tt class="docutils literal"><span class="pre">HelloController</span></tt> となるでしょう。このメソッドに渡される配列は、ターゲットコントローラーの引数になります。同じインターフェースが、テンプレートにコントローラーをエンベッドするときにも使われます (<a class="reference internal" href="templating.html#templating-embedding-controller"><em>コントローラーを埋め込む</em></a>参照)。ターゲットとなるコントローラーは次のようになります。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">fancyAction</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$color</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ... Response オブジェクトの作成をして返す</span>
<span class="p">}</span>
</pre></div>
</div>
<p>ルートに対してコントローラーを作成する場合と同様に、<tt class="docutils literal"><span class="pre">fancyAction</span></tt> へ渡す引数の順番は問題ではありません。Symfony2 は、キー(<tt class="docutils literal"><span class="pre">name</span></tt>) をメソッドの引数名(<tt class="docutils literal"><span class="pre">$name</span></tt>)とマッチさせます。引数の順番を変更した場合も、Symfony2 が適切な変数に引き渡してくれます。</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>基底 <tt class="docutils literal"><span class="pre">Controller</span></tt> の他のメソッドと同様に、<tt class="docutils literal"><span class="pre">forward</span></tt> メソッドは Symfony2 コア機能へのショートカットに過ぎません。フォワードでは、現在のリクエストが複製されます。
<em class="xref std std-ref">サブリクエスト</em> が <tt class="docutils literal"><span class="pre">http_kernel</span></tt> サービスで実行されると、<tt class="docutils literal"><span class="pre">HttpKernel</span></tt> は <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを返します。</p>
<div class="last highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpKernel\HttpKernelInterface</span><span class="p">;</span>

<span class="nv">$path</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;_controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;AcmeHelloBundle:Hello:fancy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span>        <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span>
    <span class="s1">&#39;color&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="p">);</span>
<span class="nv">$request</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>
<span class="nv">$subRequest</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">duplicate</span><span class="p">(</span><span class="k">array</span><span class="p">(),</span> <span class="k">null</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>

<span class="nv">$httpKernel</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;http_kernel&#39;</span><span class="p">);</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$httpKernel</span><span class="o">-&gt;</span><span class="na">handle</span><span class="p">(</span><span class="nv">$subRequest</span><span class="p">,</span> <span class="nx">HttpKernelInterface</span><span class="o">::</span><span class="na">SUB_REQUEST</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="controller-rendering-templates">
<span id="index-9"></span><span id="id10"></span><h3>テンプレートのレンダリング<a class="headerlink" href="#controller-rendering-templates" title="Permalink to this headline">¶</a></h3>
<p>必須条件ではないとしても、ほとんどのコントローラーでは HTML (もしくはその他のフォーマット) を生成するテンプレートのレンダリングを最終的に行うことになるでしょう。<tt class="docutils literal"><span class="pre">renderView()</span></tt> メソッドは、テンプレートをレンダリングし、コンテンツを返します。テンプレートからできたそのコンテンツは、<tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトの作成に使用されます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="nv">$content</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">renderView</span><span class="p">(</span>
    <span class="s1">&#39;AcmeHelloBundle:Hello:index.html.twig&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="nv">$content</span><span class="p">);</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">render()</span></tt> メソッドを使用すれば、これを 1 ステップで行うこともできます。このメソッドは、テンプレートからできたコンテンツを内包している <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを返します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span>
    <span class="s1">&#39;AcmeHelloBundle:Hello:index.html.twig&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>どちらの場合でも、<tt class="docutils literal"><span class="pre">AcmeHelloBundle</span></tt> 内の <tt class="docutils literal"><span class="pre">Resources/views/Hello/index.html.twig</span></tt> というテンプレートがレンダリングされます。</p>
<p>Symfony のテンプレートエンジンについては<a class="reference internal" href="templating.html"><em>テンプレート</em></a>章で詳しく説明しています。</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><tt class="docutils literal"><span class="pre">&#64;Template</span></tt> アノテーションを使うと <tt class="docutils literal"><span class="pre">render</span></tt> メソッド呼び出しの記述を省略できます。
詳細は <a class="reference internal" href="../bundles/SensioFrameworkExtraBundle/annotations/view.html"><em>FrameworkExtraBundle のドキュメント</em></a>を参照してください。</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><tt class="docutils literal"><span class="pre">renderView</span></tt> メソッドは、<tt class="docutils literal"><span class="pre">templating</span></tt> サービスを使用するショートカットです。<tt class="docutils literal"><span class="pre">templating</span></tt> サービスは、直接利用することもできます。</p>
<div class="last highlight-php"><div class="highlight"><pre><span class="nv">$templating</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;templating&#39;</span><span class="p">);</span>
<span class="nv">$content</span> <span class="o">=</span> <span class="nv">$templating</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span>
    <span class="s1">&#39;AcmeHelloBundle:Hello:index.html.twig&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>サブディレクトリにあるテンプレートをレンダリングすることもできます。
ディレクトリ構造はコントローラ名を指定する部分に記述することに注意してください。</p>
<div class="last highlight-php"><div class="highlight"><pre><span class="nv">$templating</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span>
    <span class="s1">&#39;AcmeHelloBundle:Hello/Greetings:index.html.twig&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">// Resources/views/Hello/Greetings にある index.html.twig がレンダリングされる</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="index-10">
<span id="id11"></span><h3>他のサービスへのアクセス<a class="headerlink" href="#index-10" title="Permalink to this headline">¶</a></h3>
<p>基底コントローラークラスを継承した場合は、<tt class="docutils literal"><span class="pre">get()</span></tt> メソッドを使用して、あらゆる Symfony2 サービスへのアクセスを行うことができます。一般的なサービスとしては、次のようなサービスが必要となるかもしれません。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$templating</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;templating&#39;</span><span class="p">);</span>

<span class="nv">$router</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;router&#39;</span><span class="p">);</span>

<span class="nv">$mailer</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;mailer&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>サービスは無数に存在しており、自分で定義することも自由になっています。利用可能な全てのサービスを列挙するには、コンソールコマンドの <tt class="docutils literal"><span class="pre">container:debug</span></tt> を使用してください。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>php app/console container:debug
</pre></div>
</div>
<p>詳細は <a class="reference internal" href="service_container.html"><em>サービスコンテナ</em></a> 章を参照してください。</p>
</div>
</div>
<div class="section" id="index-11">
<span id="id12"></span><h2>エラーと 404<a class="headerlink" href="#index-11" title="Permalink to this headline">¶</a></h2>
<p>&#8220;not found&#8221; になった場合は、HTTP プロトコルに沿うように 404 レスポンスを返すべきでしょう。このためには専用の例外をスローします。基底コントローラークラスを継承している場合は次のようにします。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// データベースからオブジェクトを取得する</span>
    <span class="nv">$product</span> <span class="o">=</span> <span class="o">...</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$product</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createNotFoundException</span><span class="p">(</span><span class="s1">&#39;製品が存在しません&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">createNotFoundException()</span></tt> メソッドは <tt class="docutils literal"><span class="pre">NotFoundHttpException</span></tt> オブジェクトを作成します。このオブジェクトは、Symfony 内部で最終的に 404 HTTP レスポンスを引き起こすことになります。</p>
<p>もちろん、コントローラー内ではどんな <tt class="docutils literal"><span class="pre">Exception</span></tt> クラスをスローしても問題ありません。Symfony2 は、自動的に 500 HTTP レスポンスコードを返します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">&#39;Something went wrong!&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>どの場合においても、エンドユーザーにはスタイルの整ったエラーページが表示され、(デバッグモードで見ている場合は)開発者にデバッグエラーページが表示されます。これらのエラーページは、両方ともカスタマイズが可能です。詳細は、クックブックの&#8221;<a class="reference internal" href="../cookbook/controller/error_pages.html"><em>エラーページのカスタマイズ方法</em></a>&#8220;レシピを参照してください。</p>
</div>
<div class="section" id="index-12">
<span id="id13"></span><h2>セッション管理<a class="headerlink" href="#index-12" title="Permalink to this headline">¶</a></h2>
<p>Symfony2 は、使いやすいセッションオブジェクトを提供しています。セッションオブジェクトを使って、リクエスト間でユーザー (ブラウザを使用しているユーザーや、ボット、WEB サービスでも) の情報を保存しておくことができます。デフォルトでは、Symfony2 はネイティブな PHP セッションを使用して、属性をクッキーに保存します。</p>
<p>セッションのストアと取得は、コントローラー内で容易に行うことができます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$session</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getSession</span><span class="p">();</span>

    <span class="c1">// 後のユーザーリクエストで使うために属性を保存する</span>
    <span class="nv">$session</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">);</span>

    <span class="c1">// 別のコントローラーの、別のリクエストにて</span>
    <span class="nv">$foo</span> <span class="o">=</span> <span class="nv">$session</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>

    <span class="c1">// キーが存在しない場合にデフォルト値を使う</span>
    <span class="nv">$filters</span> <span class="o">=</span> <span class="nv">$session</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;filters&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>これらの属性は、ユーザーのセッションが存続する間は保持されます。</p>
<div class="section" id="index-13">
<span id="id14"></span><h3>フラッシュメッセージ<a class="headerlink" href="#index-13" title="Permalink to this headline">¶</a></h3>
<p>ユーザーの次のリクエストまでの間のみセッションに保持されるような、小さなメッセージを保存することもできます。これは、フォームを処理しているときに便利です。リクエストをリダイレクトし、<em>次の</em>リクエストで特別なメッセージを表示させたい時に使います。この種のメッセージは「フラッシュ」メッセージと呼ばれています。</p>
<p>フォームの送信を処理する場合を考えてみましょう。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">updateAction</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$form</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createForm</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>

    <span class="nv">$form</span><span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// 何か処理をする</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;session&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span>
            <span class="s1">&#39;notice&#39;</span><span class="p">,</span>
            <span class="s1">&#39;変更が保存されました。&#39;</span>
        <span class="p">);</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="o">...</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>リクエストの処理後、コントローラーは <tt class="docutils literal"><span class="pre">notice</span></tt> というフラッシュメッセージをセットし、リダイレクトさせます。この名前 (<tt class="docutils literal"><span class="pre">notice</span></tt>) は重要ではなく、自分自身でメッセージの種類が特定できるものであれば問題ありません。</p>
<p>次に実行されるアクションのテンプレートで、<tt class="docutils literal"><span class="pre">notice</span></tt> メッセージをレンダリングするには、次のようなコードになります。</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">for</span> <span class="nv">flashMessage</span> <span class="k">in</span> <span class="nv">app.session.flashbag.get</span><span class="o">(</span><span class="s1">&#39;notice&#39;</span><span class="o">)</span> <span class="cp">%}</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;flash-notice&quot;</span><span class="nt">&gt;</span>
        <span class="cp">{{</span> <span class="nv">flashMessage</span> <span class="cp">}}</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getFlash</span><span class="p">(</span><span class="s1">&#39;notice&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;div class=&quot;flash-notice&quot;&gt;</span>
<span class="x">        </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;&lt;div class=&#39;flash-error&#39;&gt;</span><span class="si">$message</span><span class="s2">&lt;/div&gt;&quot;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;/div&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>設計的には、フラッシュメッセージは、ただ 1 回だけのリクエスト間でのみ生存するように意図されています(「瞬く(flash)間に消える」)。まさにこの例で示したような、リダイレクトをまたがる時において使われるように設計されているのです。</p>
</div>
</div>
<div class="section" id="index-14">
<span id="id15"></span><h2>レスポンスオブジェクト<a class="headerlink" href="#index-14" title="Permalink to this headline">¶</a></h2>
<p>コントローラーが満たさなければいけないただ 1 つの要件は、<tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを返すことです。<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html" title="Symfony\Component\HttpFoundation\Response"><span class="pre">Response</span></a></tt> クラスは、HTTP レスポンス (HTTP ヘッダーのテキストメッセージとクライアントに返されるべきコンテンツ) を、PHP によって抽象化しているクラスです。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="c1">// ステータスコード 200(デフォルト)の Response を作成</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Hello &#39;</span><span class="o">.</span><span class="nv">$name</span><span class="p">,</span> <span class="nx">Response</span><span class="o">::</span><span class="na">HTTP_OK</span><span class="p">);</span>

<span class="c1">// ステータスコード 200 の JSON レスポンスを作成</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)));</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.4: </span>HTTP ステータスコード定数は、Symfony 2.4 以降で利用可能です。</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><tt class="docutils literal"><span class="pre">headers</span></tt> プロパティは、<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/HeaderBag.html" title="Symfony\Component\HttpFoundation\HeaderBag"><span class="pre">HeaderBag</span></a></tt> オブジェクトとなります。このオブジェクトには <tt class="docutils literal"><span class="pre">Resopnse</span></tt> のヘッダの読み込みと変更のための便利なメソッドがついています。ヘッダ名は正規化されるので、<tt class="docutils literal"><span class="pre">Content-Type</span></tt> は <tt class="docutils literal"><span class="pre">content-type</span></tt> や、さらに言えば <tt class="docutils literal"><span class="pre">content_type</span></tt> でも同等に使用できます。</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>特定のレスポンスを手軽に返すのに有用なクラスも用意されています。</p>
<ul class="last simple">
<li>JSON 用 <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/JsonResponse.html" title="Symfony\Component\HttpFoundation\JsonResponse"><span class="pre">JsonResponse</span></a></tt>
<em class="xref std std-ref">component-http-foundation-json-response</em> を参照</li>
<li>ファイル用 <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/BinaryFileResponse.html" title="Symfony\Component\HttpFoundation\BinaryFileResponse"><span class="pre">BinaryFileResponse</span></a></tt>
<em class="xref std std-ref">component-http-foundation-serving-files</em> を参照</li>
</ul>
</div>
</div>
<div class="section" id="index-15">
<span id="id16"></span><h2>リクエストオブジェクト<a class="headerlink" href="#index-15" title="Permalink to this headline">¶</a></h2>
<p>ルーティングのプレースホルダー値もそうですが、基底 <tt class="docutils literal"><span class="pre">Controller</span></tt> クラスを継承している場合、<tt class="docutils literal"><span class="pre">Request</span></tt> オブジェクトへのアクセスも可能です。
コントローラーの引数に <cite>SymfonyComponentHttpFoundationRequest</cite> クラスのタイプヒントが指定されていれば、フレームワークにより自動的に <tt class="docutils literal"><span class="pre">Request</span></tt> オブジェクトが注入されます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">isXmlHttpRequest</span><span class="p">();</span> <span class="c1">// Ajax リクエストかどうか？</span>

    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getPreferredLanguage</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="s1">&#39;fr&#39;</span><span class="p">));</span>

    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">);</span> <span class="c1">// $_GET パラメーターを取得</span>

    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">);</span> <span class="c1">// $_POST パラメーターを取得</span>
<span class="p">}</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトと同様に、<tt class="docutils literal"><span class="pre">HeaderBag</span></tt> オブジェクト内にリクエストヘッダーの値が保存されており、容易にアクセスできます。</p>
</div>
<div class="section" id="id17">
<h2>まとめ<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<p>ページを作成するのであれば、最終的にはそのページに対するロジックの入ったコードが必要となるでしょう。Symfony では、これをコントローラーと呼んでいます。コントローラーは、ユーザーに返される最終的な <tt class="docutils literal"><span class="pre">Response</span></tt> オブジェクトを返すために必要なことがなんでもできる PHP 関数です。</p>
<p>簡単にコントローラーを実装するために、基底 <tt class="docutils literal"><span class="pre">Controller</span></tt> クラスを継承することもできます。この基底クラスには、コントローラーでよく利用される処理のショートカットメソッドが多数用意されています。例えば、コントローラー内に HTML コードを書きたくはないでしょうから、<tt class="docutils literal"><span class="pre">render()</span></tt> メソッドを使って、テンプレートからコンテンツをレンダリングし、返してもらうことができます。</p>
<p>データベースへの永続化やその取得、フォームの送信、キャッシュといったコントローラーの使い方は、他の章で説明しています。</p>
</div>
<div class="section" id="id18">
<h2>クックブックでより深く<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../cookbook/controller/error_pages.html"><em>エラーページのカスタマイズ方法</em></a></li>
<li><a class="reference internal" href="../cookbook/controller/service.html"><em>コントローラをサービスとして定義する方法</em></a></li>
</ul>
</div>
</div>


<div id="page_prev_next">
<a class="prev" href="page_creation.html">< Symfony2 でのページ作成</a>
<a class="next" href="routing.html">ルーティング ></a>
</div>

<div class="common_content_footer">
<ul>
  <li> → <a href="http://symfony.com/doc/current/book/controller.html">公式英語ドキュメント</a></li>
  <li> → <a href="https://github.com/symfony/symfony-docs/commits/master/book/controller.rst">原文コミット履歴</a>
  <li> → <a href="https://github.com/symfony-japan/symfony-docs-ja/commits/master/book/controller.rst">翻訳コミット履歴</a>
</ul>
<br />
翻訳の不備などは、お気軽にコメント欄にてご指摘ください。
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'symfony-japan'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<div class="fb-like-box" data-href="http://www.facebook.com/symfonyjapan" data-width="203" data-show-faces="true" data-stream="true" data-border-color="#FFF" data-header="true"></div>

          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>

      </div>
      <!-- end #main -->
    </div>
    <!-- end #content_wrapper -->
  </div>
  <!-- end #content -->


  <div id="footer">
    <div id="footer_wrapper">
      <div id="footer_content">
        <div style=" position: relative;">
          <div id="footer_left"></div>
          <div id="footer_right"></div>
        </div>
        <div id="f_navbar">
        <ul>
          <li><a href="../index.html">トップ（索引）</a></li>
          <li><a href="../quick_tour/index.html">クイックツアー</a></li>
          <li><a href="index.html">ガイドブック</a></li>
          <li><a href="../best_practices/index.html">ベストプラクティス</a></li>
          <li><a href="../cookbook/index.html">クックブック</a></li>
          <li><a href="../components/index.html">コンポーネント</a></li>
          <li><a href="../reference/index.html">リファレンス</a></li>
          <li><a href="../contributing/index.html">貢献</a></li>
        </ul>
      </div>
      <!-- end #navbar -->
        <div>
          <p id="copyright">
            <a href="../contributing/documentation/license.html">ドキュメントの著作権</a>は Symfony 公式に準じます(Creative Commons Attribution-Share Alike 3.0 Unported ライセンス)。<br />
            Copyright &copy; 2014 Symfony Japan. All rights reserved.<br />
            &nbsp;&nbsp;&nbsp;Bandwidth and hardware provided by <a href="http://www.asial.co.jp/">アシアル株式会社</a>
            &nbsp;&nbsp;Powered by <a href="http://sphinx.pocoo.org/">Sphinx</a>
          </p>
        </div>
      </div>
      <!-- end #footer_content -->
        </div>
        <!-- end #footer_wrapper -->
      </div>
      <!-- end #footer -->
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16659283-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>
